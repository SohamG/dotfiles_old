#/* vim: set filetype=bash : */ ~
delim="|"

wireless(){
	grep "^\s*w" /proc/net/wireless | awk '{ print "🌏", int($3 * 100 / 70) "%" }'
}
moon_phases(){
  # "Borrowed" from https://gist.github.com/zuloo/f2fed0de6ddbc0d25e2e
  local lp=2551443
  local now=$(date -u +"%s")
  local newmoon=592500
  local phase=$((($now - $newmoon) % $lp))
  local phase_number=$((((phase / 86400) + 1)*100000))

  # Multiply by 100000 so we can do integer comparison.  Go Bash!

  # if   [ $phase_number -lt 184566 ];  then phase_icon="○"  # new
  # elif [ $phase_number -lt 553699 ];  then phase_icon="❩"  # waxing crescent
  # elif [ $phase_number -lt 922831 ];  then phase_icon="◗"  # first quarter
  # elif [ $phase_number -lt 1291963 ];  then phase_icon="◑"  # first quarter
  # elif [ $phase_number -lt 1661096 ]; then phase_icon="●"  # full
  # elif [ $phase_number -lt 2030228 ]; then phase_icon="◐"  # waning gibbous
  # elif [ $phase_number -lt 2399361 ]; then phase_icon="◖"  # last quarter
  # elif [ $phase_number -lt 2768493 ]; then phase_icon="❨"  # waning crescent
  # else
    # phase_icon="○"  # new
  # fi

  if   [ $phase_number -lt 184566 ];  then phase_icon="🌑"  # new
  elif [ $phase_number -lt 553699 ];  then phase_icon="🌒"  # waxing crescent
  elif [ $phase_number -lt 922831 ];  then phase_icon="🌓"  # first quarter
  elif [ $phase_number -lt 1291963 ];  then phase_icon="🌓"  # first quarter
  elif [ $phase_number -lt 1661096 ]; then phase_icon="🌕"  # full
  elif [ $phase_number -lt 2030228 ]; then phase_icon="🌖"  # waning gibbous
  elif [ $phase_number -lt 2399361 ]; then phase_icon="🌗"  # last quarter
  elif [ $phase_number -lt 2768493 ]; then phase_icon="🌘"  # waning crescent
  else
    phase_icon="🌑"  # new
  fi
  echo $phase_icon

}
volume(){
  echo "📢"
  pactl get-sink-volume $(pactl get-default-sink) | awk '{print $5}'
}

status() {
    volume
    echo "$delim"
    moon_phases
    echo "$delim"
    wireless
    echo "$delim"

    echo "🔋"
    acpi -b | awk '{print $4}' | cut -d, -f1

    echo "$delim"

	date +'%a %d/%b %l:%M%P'
}

while :; do
	xsetroot -name "$(status | tr '\n' ' ')"

	sleep 1m
done
